# 使用轻量级的 Node.js 镜像 (Alpine 版本)
# 如果您的项目主要由 Shell 脚本组成，也可以换成 ubuntu:latest 或 alpine:latest
FROM node:lts-alpine

# 安装基础工具 (根据您的项目描述 "小钢炮脚本"，可能需要 curl, bash, git 等)
RUN apk add --no-cache \
    bash \
    curl \
    wget \
    git \
    tzdata \
    ca-certificates

# 设置工作目录
WORKDIR /app

# 1. 先复制依赖文件 (利用 Docker 缓存层)
# 如果您的项目没有 package.json，可以删除这两行
COPY package*.json ./
# 如果有 package.json，尝试安装依赖；如果没有则忽略错误
RUN if [ -f package.json ]; then npm install --production; fi

# 2. 复制剩余的所有项目文件
COPY . .

# 赋予所有脚本执行权限 (防止 Permission denied)
RUN chmod +x *.sh || true
RUN chmod +x *.js || true

# 暴露端口 (根据您的应用修改，常用 3000, 8080 等)
# EXPOSE 3000

# 启动命令
# 1. 如果是 Node 项目:
CMD ["npm", "start"]

# 2. 如果是纯 Shell 脚本项目 (例如 start.sh):
# CMD ["./start.sh"]

# 3. 如果只是想直接运行 index.js:
# CMD ["node", "index.js"]
